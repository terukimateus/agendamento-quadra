(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{31434:function(e,a,t){Promise.resolve().then(t.bind(t,79294))},5889:function(e,a,t){"use strict";t.d(a,{AuthProvider:function(){return i},a:function(){return o}});var n=t(57437),r=t(2265);let s=(0,r.createContext)(),i=e=>{let{children:a}=e,[t,i]=(0,r.useState)(null),[o,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("user");if(e&&a)try{i(JSON.parse(a))}catch(e){console.error("Failed to parse stored user data",e),localStorage.removeItem("token"),localStorage.removeItem("user")}d(!1)},[]);let c=async(e,a)=>{try{let t=await fetch("https://agendamento-azure.vercel.app/cliente/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,senha:a})});if(!t.ok){let e=await t.json();console.error(e.message),d(!1);return}let{token:n,user:r}=await t.json();localStorage.setItem("token",n),localStorage.setItem("user",JSON.stringify(r)),i(r),window.location.href="http://localhost:3000/home",d(!1)}catch(e){console.error("Failed to login",e),d(!1)}};return(0,n.jsx)(s.Provider,{value:{user:t,login:c,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),i(null),window.location.href="http://localhost:3000/"},loading:o},children:a})},o=()=>(0,r.useContext)(s)},79294:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return P}});var n=t(57437),r=t(2265),s=t(28485),i=t(42421),o=t(14392),d=t(22468),c=t(44839),l=t(96164);function u(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,l.m6)((0,c.W)(a))}let m=s.fC;s.ZA;let f=s.B4,h=r.forwardRef((e,a)=>{let{className:t,children:r,...o}=e;return(0,n.jsxs)(s.xz,{ref:a,className:u("flex h-10 w-full items-center justify-between rounded-md border border-zinc-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-zinc-800 dark:bg-zinc-950 dark:ring-offset-zinc-950 dark:placeholder:text-zinc-400 dark:focus:ring-zinc-300",t),...o,children:[r,(0,n.jsx)(s.JO,{asChild:!0,children:(0,n.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=s.xz.displayName;let p=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(s.u_,{ref:a,className:u("flex cursor-default items-center justify-center py-1",t),...r,children:(0,n.jsx)(o.Z,{className:"h-4 w-4"})})});p.displayName=s.u_.displayName;let x=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(s.$G,{ref:a,className:u("flex cursor-default items-center justify-center py-1",t),...r,children:(0,n.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=s.$G.displayName;let g=r.forwardRef((e,a)=>{let{className:t,children:r,position:i="popper",...o}=e;return(0,n.jsx)(s.h_,{children:(0,n.jsxs)(s.VY,{ref:a,className:u("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white text-zinc-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...o,children:[(0,n.jsx)(p,{}),(0,n.jsx)(s.l_,{className:u("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,n.jsx)(x,{})]})})});g.displayName=s.VY.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(s.__,{ref:a,className:u("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=s.__.displayName;let b=r.forwardRef((e,a)=>{let{className:t,children:r,...i}=e;return(0,n.jsxs)(s.ck,{ref:a,className:u("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",t),...i,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(s.wU,{children:(0,n.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(s.eT,{children:r})]})});b.displayName=s.ck.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(s.Z0,{ref:a,className:u("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",t),...r})}).displayName=s.Z0.displayName;var y=e=>{let{setCourt:a,quadras:t}=e;return(0,n.jsxs)(m,{onValueChange:a,children:[(0,n.jsx)(h,{className:"w",children:(0,n.jsx)(f,{placeholder:"Escolha sua quadra"})}),(0,n.jsx)(g,{children:t.map((e,a)=>(0,n.jsxs)(b,{value:e,children:["Quadra ",e]},a))})]})},z=t(70518),v=t(87592),j=t(19276),w=t(71538);let k=(0,t(12218).j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-zinc-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-zinc-950 dark:focus-visible:ring-zinc-300",{variants:{variant:{default:"bg-zinc-900 text-zinc-50 hover:bg-zinc-900/90 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50/90",destructive:"bg-red-500 text-zinc-50 hover:bg-red-500/90 dark:bg-red-900 dark:text-zinc-50 dark:hover:bg-red-900/90",outline:"border border-zinc-200 bg-white hover:bg-zinc-100 hover:text-zinc-900 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",secondary:"bg-zinc-100 text-zinc-900 hover:bg-zinc-100/80 dark:bg-zinc-800 dark:text-zinc-50 dark:hover:bg-zinc-800/80",ghost:"hover:bg-zinc-100 hover:text-zinc-900 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",link:"text-zinc-900 underline-offset-4 hover:underline dark:text-zinc-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}});function N(e){let{className:a,classNames:t,showOutsideDays:r=!0,...s}=e;return(0,n.jsx)(j._W,{showOutsideDays:r,className:u("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:u(k({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-zinc-500 rounded-md w-9 font-normal text-[0.8rem] dark:text-zinc-400",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-zinc-100/50 [&:has([aria-selected])]:bg-zinc-100 first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20 dark:[&:has([aria-selected].day-outside)]:bg-zinc-800/50 dark:[&:has([aria-selected])]:bg-zinc-800",day:u(k({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-zinc-900 text-zinc-50 hover:bg-zinc-900 hover:text-zinc-50 focus:bg-zinc-900 focus:text-zinc-50 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50 dark:hover:text-zinc-900 dark:focus:bg-zinc-50 dark:focus:text-zinc-900",day_today:"bg-zinc-100 text-zinc-900 dark:bg-zinc-800 dark:text-zinc-50",day_outside:"day-outside text-zinc-500 opacity-50 aria-selected:bg-zinc-100/50 aria-selected:text-zinc-500 aria-selected:opacity-30 dark:text-zinc-400 dark:aria-selected:bg-zinc-800/50 dark:aria-selected:text-zinc-400",day_disabled:"text-zinc-500 opacity-50 dark:text-zinc-400",day_range_middle:"aria-selected:bg-zinc-100 aria-selected:text-zinc-900 dark:aria-selected:bg-zinc-800 dark:aria-selected:text-zinc-50",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{...a}=e;return(0,n.jsx)(z.Z,{className:"h-4 w-4"})},IconRight:e=>{let{...a}=e;return(0,n.jsx)(v.Z,{className:"h-4 w-4"})}},...s})}r.forwardRef((e,a)=>{let{className:t,variant:r,size:s,asChild:i=!1,...o}=e,d=i?w.g7:"button";return(0,n.jsx)(d,{className:u(k({variant:r,size:s,className:t})),ref:a,...o})}).displayName="Button",N.displayName="Calendar";var _=e=>{let{date:a,setDate:t}=e;return(0,n.jsx)(N,{mode:"single",selected:a,onSelect:t,className:"rounded-md border"})},S=t(22904),I=t(7476),C=t(5889),O=t(38472);let{v4:Z}=t(81014),D=Z(),R=O.Z.create({baseURL:"https://api.mercadopago.com/v1/",headers:{accept:"application/json","content-type":"application/json",Authorization:"Bearer APP_USR-8088731663436559-070214-e9609b003c75ebc3040845ca702a6eaf-1884190882","X-Idempotency-Key":"".concat(D)}});t(72256);let E=()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("user");e||a||(window.location.href="/login")};function P(){let{user:e,logout:a}=(0,C.a)(),[t,s]=(0,r.useState)({_id:"",endereco:{cidade:"",rua:"",uf:"",cep:"",numero:""},nome:"Arena",telefone:"",coordenadas:[-23.4490604,-51.9604743],quadras:[1],distance:2.0209292912844306});(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("https://agendamento-azure.vercel.app/arena/6682db8b6d68cd9e4b640a7f"),a=await e.json();s(a)}catch(e){console.error("Failed to fetch arena data",e.message)}})()},[]);let[i,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(new Date),[l,u]=(0,r.useState)(null),[m,f]=(0,r.useState)([]),[h,p]=(0,r.useState)(null),[x,g]=(0,r.useState)(null),[b,z]=(0,r.useState)(null),[v,j]=(0,r.useState)(!1),w=()=>j(!0),k=()=>{j(!1),window.location.reload()};(0,r.useEffect)(()=>{E(),e&&o(e)},[e]),(0,r.useEffect)(()=>{(async()=>{if(l&&d)try{let e={data:d.toISOString().split("T")[0],arenaID:t._id,servicoID:"667db3b4524787cc6dd8b13f",quadras:l},a=await fetch("https://agendamento-azure.vercel.app/agendamento/dias-disponiveis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await a.json();if(n.error)console.error("Erro ao buscar hor\xe1rios dispon\xedveis:",n.message);else{let e=n.agenda.flatMap(e=>e.horarios);f(e)}}catch(e){console.error("Erro ao fazer a requisi\xe7\xe3o:",e)}})()},[l,d]);let N=e=>{e===h?p(null):p(e)},O=async(e,a)=>{try{for(;"approved"!==x;){let t=await R.get("/payments/".concat(e));if("approved"===t.data.status){await fetch("https://agendamento-azure.vercel.app/agendamento/".concat(a),{method:"PUT"}),w();break}console.log("Pagamento ainda n\xe3o aprovado. Verificando novamente em 5 segundos."),await new Promise(e=>setTimeout(e,5e3))}}catch(e){console.error("Erro ao verificar pagamento:",e)}};return(0,n.jsx)("main",{children:(0,n.jsxs)("div",{className:"w-full h-screen flex items-center flex-col py-4",children:[(0,n.jsxs)("div",{className:"w-8/12 items-center flex justify-between",children:[(0,n.jsx)("span",{className:"text-xl font-black",children:t.nome||"Nome da Arena"}),(0,n.jsxs)("div",{className:"flex gap-3",children:[i&&(0,n.jsxs)("span",{children:["Bem vindo, ",i.person.nome.first_name]}),(0,n.jsx)("button",{onClick:()=>{a()},children:"Logout"})]})]}),(0,n.jsxs)("div",{className:"w-full h-full flex flex-col py-16 items-center",children:[(0,n.jsxs)("div",{className:"w-8/12 flex items-center flex-col gap-5",children:[(0,n.jsx)("div",{children:(0,n.jsx)(_,{date:d,setDate:c})}),t&&(0,n.jsx)(y,{setCourt:u,quadras:t.quadras})]}),(0,n.jsxs)("div",{className:"w-8/12 flex items-center flex-col py-4",children:[(0,n.jsxs)("span",{className:"text-xl font-bold",children:["Quadra ",l," | ",null==d?void 0:d.toLocaleDateString()]}),(0,n.jsx)("div",{className:"shrink-0 bg-border h-[1px] w-full my-4"}),m.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-xl font-bold",children:"Horarios Disponiveis"}),(0,n.jsx)("div",{className:"grid grid-cols-3 py-4 gap-3",children:m.map((e,a)=>(0,n.jsx)("button",{className:"p-3 rounded-xl text-base duration-500 ".concat(h===e?"bg-emerald-400":"bg-neutral-300"),value:e,onClick:()=>N(e),children:e},a))}),(0,n.jsx)("button",{className:"p-4 text-md bg-emerald-400 rounded-xl hover:scale-105 duration-500",onClick:()=>{(async()=>{try{let e={clienteID:i._id,data:d.toISOString(),arenaID:t._id,servicoID:"667db3b4524787cc6dd8b13f",quadras:l},a=await fetch("https://agendamento-azure.vercel.app/agendamento/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await a.json();n.agendamentos&&n.agendamentos.transactionID?(z(n),g("pending"),O(n.agendamentos.transactionID,n.agendamentos._id)):console.error("Transaction ID not found in response")}catch(e){console.error("Erro ao criar agendamento:",e)}})()},children:"Agendar"})]}):(0,n.jsx)("span",{className:"text-lg font-bold",children:"Sem hor\xe1rios dispon\xedveis"})]}),b?(0,n.jsxs)("div",{className:"flex flex-col justify-center items-center text-center py-10",children:[(0,n.jsx)("span",{children:"Seu agendamento sera efetuado apenas ap\xf3s o pagamento."}),(0,n.jsx)("img",{style:{width:"10rem"},className:"object-fit border-none w-6/12",src:"data:image/jpeg;base64,".concat(b.payment.point_of_interaction.transaction_data.qr_code_base64),alt:"QR Code"}),(0,n.jsx)("span",{children:"O QR Code tem v\xe1lidade de 30 minutos"})]}):null,(0,n.jsx)("div",{children:(0,n.jsxs)(S.Z,{open:v,onClose:k,children:[(0,n.jsx)(S.Z.Header,{children:(0,n.jsxs)("span",{className:"flex items-center gap-2 text-xl text-green-500",children:[(0,n.jsx)(I._rq,{})," Sucesso"]})}),(0,n.jsx)(S.Z.Body,{children:"O seu pagamento foi efetuado com sucesso! Seu agendamento j\xe1 foi conclu\xeddo."}),(0,n.jsx)(S.Z.Footer,{children:(0,n.jsx)("button",{onClick:k,children:"Ok"})})]})})]})]})})}}},function(e){e.O(0,[454,956,833,752,971,23,744],function(){return e(e.s=31434)}),_N_E=e.O()}]);